import requests
import pandas as pd

# URL de la API
url = "https://data.cityofnewyork.us/resource/ic3t-wcy2.json"

# Solicitud GET a la API
response = requests.get(url)

# Verificaci칩n del estado de la respuesta
if response.status_code == 200:
    # Conversi칩n de los datos JSON a un DataFrame de Pandas
    data = response.json()
    df = pd.DataFrame(data)
    print(df.head())
    
    # Limpieza de los datos (eliminaci칩n de columnas con m치s del 50% de valores nulos)
    df_cleaned = df.loc[:, df.isnull().mean() < 0.5]
    
    # Guardar los datos limpiados en un archivo Parquet
    df_cleaned.to_parquet('cleaned_data.parquet', index=False)
    print("Datos limpiados y guardados como 'cleaned_data.parquet'")
else:
    print("Error al obtener los datos")
